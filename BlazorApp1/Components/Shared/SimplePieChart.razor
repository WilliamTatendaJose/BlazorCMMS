@* Simple CSS-based Pie Chart Component *@
@if (Total > 0)
{
    <div class="simple-pie-chart" style="display: flex; flex-direction: column; align-items: center;">
        <div style="position: relative; width: 200px; height: 200px;">
            <svg viewBox="0 0 200 200" style="width: 200px; height: 200px;">
                @{
                    double currentAngle = 0;
                    var segments = new[] 
                    {
                        new { Value = HealthyCount, Color = "#43a047", Label = "Healthy" },
                        new { Value = WarningCount, Color = "#fb8c00", Label = "Warning" },
                        new { Value = CriticalCount, Color = "#e53935", Label = "Critical" }
                    };

                    foreach (var segment in segments)
                    {
                        if (segment.Value > 0)
                        {
                            var percentage = (double)segment.Value / Total;
                            var angle = percentage * 360;
                            var largeArc = angle > 180 ? 1 : 0;
                            
                            var startX = 100 + 80 * Math.Cos((currentAngle - 90) * Math.PI / 180);
                            var startY = 100 + 80 * Math.Sin((currentAngle - 90) * Math.PI / 180);
                            var endX = 100 + 80 * Math.Cos((currentAngle + angle - 90) * Math.PI / 180);
                            var endY = 100 + 80 * Math.Sin((currentAngle + angle - 90) * Math.PI / 180);
                        
                            <path d="M 100 100 L @startX @startY A 80 80 0 @largeArc 1 @endX @endY Z"
                                  fill="@segment.Color" 
                                  stroke="white" 
                                  stroke-width="2"/>
                        
                            currentAngle += angle;
                        }
                    }
                }
                <circle cx="100" cy="100" r="50" fill="white"/>
            </svg>
            
            <!-- Center labels overlay -->
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; pointer-events: none;">
                <div style="font-size: 24px; font-weight: 700; color: #37474f;">@Total</div>
                <div style="font-size: 12px; color: #78909c;">Assets</div>
            </div>
        </div>
        
        <div style="margin-top: 20px; text-align: center;">
            <div style="margin-bottom: 8px;"><span style="color: #43a047; font-size: 20px;">?</span> <strong>@HealthyCount</strong> Healthy (@(Total > 0 ? (HealthyCount * 100 / Total) : 0)%)</div>
            <div style="margin-bottom: 8px;"><span style="color: #fb8c00; font-size: 20px;">?</span> <strong>@WarningCount</strong> Warning (@(Total > 0 ? (WarningCount * 100 / Total) : 0)%)</div>
            <div><span style="color: #e53935; font-size: 20px;">?</span> <strong>@CriticalCount</strong> Critical (@(Total > 0 ? (CriticalCount * 100 / Total) : 0)%)</div>
        </div>
    </div>
}
else
{
    <div style="text-align: center; padding: 40px; color: var(--rbm-text-light);">
        No asset data available
    </div>
}

@code {
    [Parameter] public int HealthyCount { get; set; }
    [Parameter] public int WarningCount { get; set; }
    [Parameter] public int CriticalCount { get; set; }
    
    private int Total => HealthyCount + WarningCount + CriticalCount;
}
